\section{Results and Discussion} \label{sec:results}

In this work, we investigate the interactions between population size, adaptive potential, and population structure in influencing selection on mutator traits within asexual populations.
In our first experiments, we replicate previous work by \citet{raynes2018sign} showing sign-change effects of population size on mutator favorability.
Subsequent experiments investigate how these dynamics change when limited beneficial mutations are available and their sensitivity to initial abundance of mutators in the population.
Finally, experiments survey behavior across three regimes of population spatial structure.
We find that the sign effect of population size on mutator favorability is dependent on spatial structure.

\subsection{Scaling Population Size}
\label{sec:scaling-population-size}

In a first set of experiments, we tested the capability of our model to reproduce the qualitative regimes of mutator dynamics across population scales identified by \citet{raynes2018sign}.
In the first regime, where population size is very small, fixation of mutator and nonmutator alleles is nearly equiprobable, owing to the overwhelming influence of stochastic effects.
Subsequently, in medium-sized populations, mutators become disfavored on account of increased power of selection becoming in penalizing the increased mutational load imposed by mutator allelees.
Finally, in sufficiently large populations, a sign-change fitness effect occurs and mutator fixation becomes overwhelmingly favored.
This effect occurs in asexual populations because population size increases the probability of at least one mutator discovering a beneficial mutation, and so ``hitch-hiking'' to sweep out nonmutators.

\input{fig/wse-inf-one}

As shown in the left panel of Figure \ref{fig:wse-inf-one:32}, our simulations reproduce the sign-change fitness effect described by \citet{raynes2018sign}.
Leveraging the capabilites of WSE accelerator hardware, we tested population sizes several orders of magnitude beyond those reported in \citet{raynes2018sign}.
For these experiments, 2D population structure was used with 50/50 initialization.
In line with expectations, no further qualitative differences in mutator fixation probability emerged in these larger population sizes, which ranged up to 1 billion agents.
For the largest-scale trials, shown left panel of Figure \ref{fig:wse-inf-one:2048}, an increased subpopulation sizes 2,048 agents per deme was used.
As such, in these trials, note that coarsened spacing between surveyed population sizes obscures the sign-change fitness effect near the lower bound of population size.

\subsection{Restricting Adaptive Potential}
\label{sec:restricting-adaptive-potential}

Next, we sought to establish how adaptive potential interacts with current synthesis of the role of population size in mediating mutator dynamics.
One assumption of existing work by \citet{raynes2018sign} is availability of abundant potential beneficial mutations.
Existing simulation studies suggest restricting adaptive potential should disfavor mutator alleles \citep{tenaillon1999mutators}, but understanding of how this effect interacts with other factors is limited.

To investigate this question, we next performed experiments where the supply of possible beneficial mutations was constrained.
As for the above results, experiments were conducted on the WSE platform using 2D population structure with 50/50 initialization.
The right panels of \cref{fig:wse-inf-one:32,fig:wse-inf-one:2048} show mutator fixation probabilities where agents could accrue no more than one beneficial mutation, for trials usig 32- and 2,048 agents per deme respectively.
In both cases, a second sign-change fitness effect for mutator traits appears, with nonmutators regaining favor past population sizes of 100,000 agents.
Beyond population sizes of 1 million agents, nonmutators reliably drive mutators to extinction.

These results substantiate an earlierverbal hypothesis by \citet{desai2011balance} that more than one beneficial mutation should become necessary to fix a mutator allele when fixation time becomes long, as is the case with large population size.
Rationale behind this expectation is that where fixation time is long, nonmutators become likely to also discover a comparable beneficial allele before being driven to extinction.
From this point, disadvantage in mutational load dooms the mutator allele.

\input{fig/avail-ben-muts}

Next, we tested sensitivity of the relationship between mutator fixation probability and population size with respect to the amount of adaptive potential available.
Figure \ref{fig:avail-ben-muts} shows fixation curves where one, two, three, four, and five beneficial mutations are available, conducted with 256 agents per deme.
Under surveyed conditions, with 2D spatial structure and mutators initially in equal proportion to nonmutators, nonmutator persistence rapidly decays with increases in adaptive potential.
Even with the largest-surveyed billion-agent population size, mutators regain selective parity where four or more beneficial mutations are available.
Interestingly, this result may help explain an earlier observation by \citet{tenaillon1999mutators} that below a threshold of four beneficial mutations available, mutator alleles never rose from background levels to fix within their compartment-based model of a well-mixed billion-member population.
Notwithstanding differences in model parameterization and population structure, our findings suggest thi threshold may coincide with the point where the net fitness effect of the mutator allele neutralizes in commensurately-scaled populations.

\input{fig/avail-ben-muts-gen}

Given that experiments conducted on the WSE platform all involve 2D spatial structure, we implemented an additional set of GPU-based experiments to compare findings with well-mixed population structure.
Figure \ref{fig:avail-ben-muts-gen} overviews these results.
Although experments ranged up to a smaller maximum population size on the GPU platform, detected regimes of mutator dynamics are consistent with WSE-based experiments.
Comparing on the basis of spatial structure, we find fixation probabilities to be near-identical between GPU-based trials using 2D and well-mixed structure across surveyed conditions.
Corrected for multiple comparisons using the Holm-Bonferroni method, we find significant divergence in fixation probability only for TODO (TODO).
% https://github.com/mmore500/hypermutator-dynamics/issues/38

\subsection{Effects of Background Mutator Prevalence}
\label{sec:background-hypermutator-prevalence}

Over the course of history studying mutator dynamics, there has been some question as to whether selection on mutators is number-, frequency-, or density-dependent, reviewed in \citep{raynes2019selection}.
(Note that this issue is orthogonal to overall population size.)
One key result in recent years is that selection on mutators is not frequency- or density-dependent, definitively described in \citep{raynes2019selection} but earlier suggested in \citep{wylie2009fixation}.
One straightforward consequence of this finding is simplification of experimental design.
Rather than trying to design competition experiments that capture dynamics when mutators are rare, direct experiments may be designed where mutators and nonmutators are mixed in even proportions at a starting point.
This is good because it provies sensitivity in detecting within the realm where mutator and nonmutator fixation probabilities and facilitates an intuitive and direct comparison of favor vs. disfavor for the mutator allele.
This sensitivity is useful in characterizing sign-change effects \citep{raynes2019selection}.

\input{fig/denovo-5050-conditions-combined}

Having observed large population size stabilize nonmutators against extinction when few opportunities for adaptive mutation exist, we next sought to assess how robustly such a protective effect might manifest in natural populations.
In this regard, we sought to test the role of initial conditions in mutator fixation outcomes by relaxing the assumption that mutators begin ``50/50'' in equal proportion to nonmutators.
Although such a scenario provides a useful design for benchtop experiments \citep{raynes2018sign}, against a background of evolutionary stasis it would, instead, be expected that nonmutators instead exist in the population at some low background rate resulting equilibrium between purifying selection and spontaneous mutator originations \citep{desai2011balance,johnson1999approach}.

Prior work, applying both mathematical analysis and agent-based experiments, has shown per-capita favorability of mutator traits to be density independent \citep{raynes2019selection}.
Thus, we would expect a lower background rate for mutator alleles to reduce the net probability of nonmutator extinction.

To test this question, we conducted ``\textit{de novo}'' treatments where mutators arose spontaneously rather than being explicitly included in the initial population.
Given that we assume the availability of some nonzero number of adaptive mutations, such a scenario might be applicable to cases where an abrupt change in environmental context introduces adaptive potential, such as the sudden introduction of a novel stressor.
Note that, in our simulation experiments, we assumed mutators to originate with probability equivalent to beneficial mutations, $10^{-6}$.

Figure \ref{fig:denovo-5050-conditions} compares surveyed mutator fixation probabilities with and without mutators making up half of the initial population.
With 256 agents per deme, population size scaled up to 136 million agents.
In line with expectations, the \textit{de novo} treatment substantially extends nonmutator viability.
Under \textit{de novo} conditions, nonmutators reliably resist mutator fixation in very large populations through more than 10 beneficial mutations available.
Under 50/50 conditions, by contrast, mutators begin to fix in very large populations past 2 beneficial mutations available.

As can be seen by comparing panels \ref{fig:denovo-5050-conditions:poisson} and \ref{fig:denovo-5050-conditions:site-explicit}, we found outcomes to be generally consistent between both the counter-based model with Poisson-distributed mutations and an alternate ``site-explicit'' model where the probability of discovering a beneficial mutation scales proportional to the number available.

\subsection{Effects of Population Structure}
\label{sec:population-structure}

In a final set of experiments, we sought to establish the influence of spatial structure on fixation outcomes to further assess how robustly natural asexual populations might resist mutator fixation in scenarios with limited adaptation potential.

The simulation experiments described above, conducted on WSE hardware, all assumed a global population structure as an interconnected 2D grid of smaller, well-mixed constituent demes.
To explore this dimension, we conducted trials with the default 2D structure along with (1) a treatment arranging demes in a 1D ring and (2) a fully well-mixed treatment with no subpopulation structure.
Because work reported in this section used a GPU platform, rather than WSE, population sizes ranged only up to 15 million agents.

\input{fig/spatial-structure-combined}

Figure \ref{fig:spatial-structure} plots increase in mutator fixation probabilities with available adaptive potential across a spectrum of population sizes.
Results differ substantially between 50/50 and \textit{de novo} conditions, appearing in panels \ref{fig:spatial-structure:5050} and \ref{fig:spatial-structure:denovo} respectively.
With 50/50 initializations, nonmutators reliably persist through only one or two beneficial mutations available across all spatial configurations.
By contrast, under \textit{de novo} conditions, nonmutator populations with 1D structure successfully resist mutator invasion through upwards of 20 beneficial mutations.
Notably, though, under weak, well-mixed spatial structure, the effect of population size is opposite --- rather than suppressing mutator favorability, mutators actually become \textit{more} likely to sweep large populations.

These findings contrast with previous modeling work assuming unlimited adaptive potential, which predicts that so long as any level of connectivity exists between subpopulations, spatial structure boosts mutator fixation probability \citep{raynes2019migration}.
One possible explanation for why spatial structure can decrease mutator fixation probability is by extending the window of opportunity for nonmutators to catch up in exploiting available adaptive potential before being driven to extinction.
Such a possibility aligns with findings from \textit{in vivo} evolution experiments with \textit{E. coli} that show that migration barriers delaying introduction of mutator strains into nonmutator populations can reduce mutator advantage \citep{lechat2006escherichia}.

\subsection{Spatiotemporal Dynamics}
\label{sec:dynamics}

To better understand how competition between non- and mutator strains unfolds at very large population scales, we performed an additional set of simulations on the WSE using the site-explicit model of adaptation, where mutators originated \textit{de novo} from nonmutator strains.
For these experiments, PE subpopulations were restricted to 256 agents to preserve on-device memory to record time series data.
This configuration yielded a net population size of 191 million agents.
In these runs, we probed the critical region where outcomes transition between nonmutator and mutator fixation, configuring adaptive potential between 12 and 16 available beneficial mutations.

In order to track the composition of the population over time, we included additional on-device, runtime instrumentation in these replicates.
Generation-on-generation, we configured each processor element to sample a genome from its local population and record its mutator allele (i.e., a binary value as either a non- or mutator).
To efficiently curate this single-bit data within per-PE memory limits, we leveraged recently-introduced ``DStream'' generalizations of the ring buffer data structure \citep{moreno2024algorithms}.
Notably, this approach constrained memory use to a fixed-size buffer, while guaranteeing the buffer to always be fully utilized.
Additionally, recording could thereby be dynamically halted when nonmutators were determined to be locally extinct (and restarted if they are reintroduced).
While this scheme allowed maximization of on-device resources, note that, as a result, in animations the number of generations elapsed per frame varies depending on when, and if, nonmutators went to extinction.

\input{fig/dynamics}

Figure \ref{fig:dynamics} arranges sequential population snapshots from two example simulations, both with adaptive potential of 14 beneficial mutations.
In the first example, mutators fixed; in the second, they did not.

At outset, example simulations in panels \ref{fig:dynamics:no-fixation} and \ref{fig:dynamics:fixation} unfold similarly.
First, mutator strains appear \textit{de novo} across the breadth of simulated populations.
Then, as patches of mutators expand outwards, the nonmutator population is broken into pockets.%
\footnote{%
Notably, mutator strains continue to stem from nonmutator lineages as they accrue adaptive mutations.
Of 16 replicates where mutators fixed, we observed 2 cases where the final dominant mutator lineage arose from a partially-adapted nonmutator lineage --- harboring 1 and 3 beneficial mutations, respectively.
% https://github.com/mmore500/hypermutator-dynamics/blob/90422b30f2dd9ca29baad273cbcc676dbfeab55f/binder/wse-denovo-spatial2d-explicitsite-genomes.ipynb
}
In scenarios where mutators fix, surviving patches of nonmutators dwindle away entirely (panel \ref{fig:dynamics:fixation}).
Alternately, where nonmutators survive, they re-establish via concentric growth from surviving pockets (panel \ref{fig:dynamics:no-fixation}).

\input{fig/peaksweep}

At nadir, nonmutators constitute less than 0.1\% of the population in experiments with adaptive potential of 14 available beneficial mutations.
% ^^^ https://github.com/mmore500/hypermutator-dynamics/blob/5e904ac2fbbd4b41a0ad679883fc1a63af71c00c/binder/wse-denovo-spatial2d-explicitsite-timeseries.ipynb
To assess the peak of transient presence of mutators within, we performed an additional set of four-replicate simulations ranging from adaptive potentials of 2 to 10 available beneficial mutations.
For all replicates with 6 or more available beneficial mutations, mutators peaked beyond 50\% prevalence (Figure \ref{fig:peaksweep}).

\begin{figure}[h]
  % adapted from https://tex.stackexchange.com/a/122813/316176
  \captionsetup[subfigure]{justification=raggedright}
  \begin{minipage}{\textwidth}

    \begin{minipage}{0.1\textwidth}~\end{minipage}%
    \begin{minipage}{0.25\textwidth}
      \centering
      \itshape
      {\large
      \textbf{weak} population structure
      }
      (well-mixed)
    \end{minipage}%
    \begin{minipage}{0.25\textwidth}
      \centering
      \itshape
      {\huge
      $\longleftrightarrow$
      }

      (2D demes)
    \end{minipage}%
    \begin{minipage}{0.25\textwidth}
      \centering
      \itshape
      {\large
      \textbf{strong} population structure
      }

      (1D demes)
    \end{minipage}

    ~\vspace{-0.7ex}

    % Top subfigure
    \begin{subfigure}[b]{\linewidth}
        \begin{minipage}{0.3\textwidth}
          \includegraphics[height=5.2cm, trim={0cm 0.8cm 3.9cm 0cm}, clip]{binder/binder-cupy-5050-wellmixed-traits.ipynb/binder/teeplots/cupy-5050-wellmixed-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
        \end{minipage}%
        \begin{minipage}{0.06\textwidth}
          ~
        \end{minipage}%
        \begin{minipage}{0.26\textwidth}
          \includegraphics[height=5.2cm, trim={2.1cm 0.8cm 3.9cm 0cm}, clip]{binder/binder-cupy-5050-spatial2d-traits.ipynb/binder/teeplots/cupy-5050-spatial2d-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
        \end{minipage}%
        % \begin{minipage}{0.05\textwidth}
        %   ~
        % \end{minipage}%
        \begin{minipage}{0.25\textwidth}
          \includegraphics[height=5.2cm, trim={2.1cm 0.8cm 4.75cm 0cm}, clip]{binder/binder-cupy-5050-spatial1d-traits.ipynb/binder/teeplots/cupy-5050-spatial1d-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
        \end{minipage}%
      \begin{minipage}{0.12\textwidth}
        \raggedright
        \large
        \caption{50/50 initial conditions}
        \label{fig:spatial-structure:5050}
        \vspace{20ex}
      \end{minipage}%
    \end{subfigure}%

    \vspace{-10ex}

    % Bottom subfigure
    \begin{subfigure}[b]{\linewidth}
 \begin{minipage}{0.3\textwidth}
  \begin{tikzpicture}
    \node[anchor=south west, inner sep=0] (image) at (0,0) {
      \includegraphics[height=5.2cm, trim={0cm 0.8cm 3.9cm 0cm}, clip]{binder/binder-cupy-denovo-wellmixed-traits.ipynb/binder/teeplots/cupy-denovo-wellmixed-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}
    };
    \begin{scope}[x={(image.south east)}, y={(image.north west)}]
      \fill[white] (0.363, 0.27) rectangle (0.455, 0.82);  % censor
    \end{scope}
  \end{tikzpicture}
\end{minipage}
        \begin{minipage}{0.06\textwidth}
          ~
        \end{minipage}%
        \begin{minipage}{0.26\textwidth}
\begin{tikzpicture}
  \node[anchor=south west, inner sep=0] (image) at (0,0) {
    \includegraphics[height=5.2cm, trim={2.3cm 0.8cm 3.9cm 0cm}, clip]{binder/binder-cupy-denovo-spatial2d-traits.ipynb/binder/teeplots/cupy-denovo-spatial2d-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
  };
  \begin{scope}[x={(image.south east)}, y={(image.north west)}]
    \fill[white] (0.048, 0.27) rectangle (0.185, 0.82);  % censor
  \end{scope}
\end{tikzpicture}
        \end{minipage}%
        % \begin{minipage}{0.05\textwidth}
        %   ~
        % \end{minipage}%
        \begin{minipage}{0.25\textwidth}
\begin{tikzpicture}
  \node[anchor=south west, inner sep=0] (image) at (0,0) {
    \includegraphics[height=5.2cm, trim={2.3cm 0.8cm 4.7cm 0cm}, clip]{binder/binder-cupy-denovo-spatial1d-traits.ipynb/binder/teeplots/cupy-denovo-spatial1d-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
  };
  \begin{scope}[x={(image.south east)}, y={(image.north west)}]
    \fill[white] (0.057, 0.27) rectangle (0.225, 0.82);  % censor
  \end{scope}
\end{tikzpicture}
        \end{minipage}%
      \begin{minipage}{0.12\textwidth}
        \raggedright
        \large
        \vspace{10ex}
        \caption{\textit{de novo} initial conditions}
        \label{fig:spatial-structure:denovo}

        \includegraphics[height=5.5cm, trim={7.3cm 0cm 0cm 0cm}, clip]{binder/binder-cupy-denovo-spatial1d-traits.ipynb/binder/teeplots/cupy-denovo-spatial1d-traits/col=population-size+errorbar=ci+hue=genotype+layout=skinny+viz=size-fixation-cliffplot+x=fixation-probability+y=available-beneficial-mutations+ext=.pdf}%
      \end{minipage}%
    \end{subfigure}%

  \end{minipage}

  \vspace{-10ex}

  \begin{minipage}{\textwidth}
    \caption{%
      \textbf{Population structure increases normomutator resilience to available adaptive potential.}
      \footnotesize
      Areaplot strips track hypermutator fixation probability across surveyed levels of adaptive potential, with error bands indicating bootstrapped 95\% confidence intervals.
      Strips are arranged left-to-right with ascending population size, marked on the top axis.
      Leftmost column shows well-mixed conditions.
      Populations in center and rightmost columns are subdivided into 256-agent demes, arranged in a 2D grid or 1D ring.
      Top panel, \ref{fig:spatial-structure:5050}, reports experiments initialized with an even mix of hyper- and normomutator agents.
      In bottom panel, \ref{fig:spatial-structure:denovo}, hypermutators are initially absent and arise spontaneously \textit{de novo} with probability $10^{-6}$.
      Note that $y$-axis scale differs substantially between top and bottom panels.
      Effects of population structure are more pronounced under \textit{de novo} conditions, when initial supply of hypermutators is scarce.
      Under well-mixed conditions, increase in population size favors hypermutators; normomutators reliably persist in very large populations through fewer than 10 available beneficial mutations.
      In contrast, under 1D deme structure, very large population sizes are favorable to normomutators.
      With such strong spatial structure, very large populations of normomutators reliably resist hypermutator fixation even when upwards of 20 beneficial mutations are available.
      Results are under GPU simulation, using counter-based genome model.
      In lower panel, some treatments with smallest population size were unable to reliably fix all available beneficial mutaitons within allotted runtime; panel areas in these regimes are left blank.
      Supplementary Figures \cref{fig:fixheat-5050-cupy,fig:fixheat-denovo-cupy} detail results in a tabular format.
    }
    \label{fig:spatial-structure}
  \end{minipage}
\end{figure}
